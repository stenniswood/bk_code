CC = g++
CFLAGS = 
PROG = home3d
INC		   = ./ ./atoms/ ./molecules/ /usr/local/include

SRCS 	   = main.o imageloader.o room2.o 
ATOMS_SRCS = gl_atom.o gl_object.o Texture.o extrusion.o ibeam.o stairway.o door.o \
			 txt_container.o wall.o gl_container.o cylinder.o robot_leg_piece.o \
			 paper.o abstract_wall.o Map2D.o
MOLECULES_SRCS = table.o brickwall.o cabinet.o palette.o counter.o drawer.o 
ALL_SRCS = $(SRCS) $(ATOMS_SRCS) $(MOLECULES_SRCS)

ifeq ($(shell uname),Darwin)
	LIBS = -framework OpenGL -framework GLUT 
else
	LIBS = -lglut
endif
LIBS +=  -lpthread -lm -L./lib -lfreenect -L/usr/local/lib/ 			 \
		-lopencv_core -lopencv_highgui -lopencv_imgproc -lopencv_calib3d \
		-lopencv_ml -lopencv_objdetect -lopencv_ts -lopencv_imgcodecs

%.o: %.cpp $(DEPS)
	$(CC) $(CFLAGS) $(addprefix -I,$(INC)) -c -o $@ $< $(OPTIONS) 
%.o: %.c $(DEPS) 
	$(CC) $(CFLAGS) $(addprefix -I,$(INC)) -c -o $@ $< $(OPTIONS) 

all: $(PROG)

$(PROG): $(SRCS)  \
		$(addprefix ./atoms/, 	  $(ATOMS_SRCS)) 		\
		$(addprefix ./molecules/, $(MOLECULES_SRCS))
		$(CC) $(CFLAGS) $^ -o $(PROG)  $(LIBS)

clean:
	rm -f $(PROG)
	rm -rf ./atoms/*.o 
	rm -rf ./molecules/*.o 
